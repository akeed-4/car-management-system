<div class="container mx-auto p-6">
  <h2 class="text-2xl font-semibold text-gray-800 mb-6">التقارير الإدارية</h2>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Best Selling Cars Table -->
    <div class="bg-white p-6 rounded-lg shadow-md">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">السيارات الأكثر مبيعاً</h3>
      <div class="mb-4">
        <input 
          type="text" 
          placeholder="ابحث عن سيارة..."
          (input)="onBestSellerFilter($event)"
          [value]="bestSellerFilter()"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th 
                scope="col" 
                class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100"
                (click)="onBestSellerSort('description')"
              >
                <div class="flex items-center justify-between">
                  <span>وصف السيارة</span>
                  <span class="mr-2">{{ getBestSellerSortIcon('description') }}</span>
                </div>
              </th>
              <th 
                scope="col" 
                class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100"
                (click)="onBestSellerSort('quantitySold')"
              >
                <div class="flex items-center justify-between">
                  <span>الكمية المباعة</span>
                  <span class="mr-2">{{ getBestSellerSortIcon('quantitySold') }}</span>
                </div>
              </th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            @for (car of bestSellingCars(); track car.description) {
              <tr class="hover:bg-gray-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                  {{ car.description }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                  {{ car.quantitySold }}
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="2" class="px-6 py-4 text-center text-sm text-gray-500">
                  لا توجد بيانات متاحة
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>

    <!-- Top Salespeople Table -->
    <div class="bg-white p-6 rounded-lg shadow-md">
      <h3 class="text-xl font-semibold text-gray-700 mb-4">أفضل موظفي المبيعات</h3>
      <div class="mb-4">
        <input 
          type="text" 
          placeholder="ابحث عن موظف..."
          (input)="onSalespersonFilter($event)"
          [value]="salespersonFilter()"
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
      </div>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th 
                scope="col" 
                class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100"
                (click)="onSalespersonSort('name')"
              >
                <div class="flex items-center justify-between">
                  <span>اسم الموظف</span>
                  <span class="mr-2">{{ getSalespersonSortIcon('name') }}</span>
                </div>
              </th>
              <th 
                scope="col" 
                class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100"
                (click)="onSalespersonSort('totalSales')"
              >
                <div class="flex items-center justify-between">
                  <span>إجمالي المبيعات</span>
                  <span class="mr-2">{{ getSalespersonSortIcon('totalSales') }}</span>
                </div>
              </th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            @for (person of topSalespeople(); track person.name) {
              <tr class="hover:bg-gray-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                  {{ person.name }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                  {{ person.totalSales | currency:'EGP':'symbol':'1.2-2' }}
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="2" class="px-6 py-4 text-center text-sm text-gray-500">
                  لا توجد بيانات متاحة
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>