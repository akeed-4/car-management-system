<div class="store-list-container">
  <div class="header">
    <h2>{{ 'STORES.LIST_TITLE' | translate }}</h2>
    <div class="actions">
      <input
        type="text"
        [(ngModel)]="filter"
        placeholder="{{ 'STORES.SEARCH_PLACEHOLDER' | translate }}"
        class="search-input"
      />
      <button
        mat-raised-button
        color="primary"
        (click)="onCreate()"
        appHasPermission="store.create">
        <mat-icon>add</mat-icon>
        {{ 'STORES.ADD_NEW' | translate }}
      </button>
    </div>
  </div>

  <dx-data-grid
    [dataSource]="filteredStores()"
    [showBorders]="true"
    [showRowLines]="true"
    [showColumnLines]="true"
    [rowAlternationEnabled]="true"
    [allowColumnReordering]="true"
    [allowColumnResizing]="true"
    [columnAutoWidth]="true"
    [wordWrapEnabled]="true"
    [rtlEnabled]="true"
    [hoverStateEnabled]="true"
    [selection]="{ mode: 'single' }"
    (onRowClick)="onRowClick($event)"
    height="70vh">

    <dxo-load-panel [enabled]="true"></dxo-load-panel>
    <dxo-scrolling mode="virtual"></dxo-scrolling>
    <dxo-paging [pageSize]="10"></dxo-paging>
    <dxo-pager [showPageSizeSelector]="true" [allowedPageSizes]="[5, 10, 20]" [showInfo]="true"></dxo-pager>
    <dxo-filter-row [visible]="true"></dxo-filter-row>
    <dxo-header-filter [visible]="true"></dxo-header-filter>
    <dxo-search-panel [visible]="true" [placeholder]="'STORES.SEARCH_PLACEHOLDER' | translate"></dxo-search-panel>
    <dxo-export [enabled]="true" fileName="stores"></dxo-export>
    <dxo-grouping [autoExpandAll]="false"></dxo-grouping>
    <dxo-sorting mode="multiple"></dxo-sorting>

    <dxi-column
      dataField="name"
      [caption]="'STORES.COLUMNS.NAME_EN' | translate"
      [allowFiltering]="true"
      [allowSorting]="true"
      [allowGrouping]="true"
     >
    </dxi-column>


    <dxi-column
      dataField="description"
      [caption]="'STORES.COLUMNS.DESCRIPTION' | translate"
      [allowFiltering]="true"
      [allowSorting]="false"
      [allowGrouping]="true"
      [width]="250">
    </dxi-column>

    <dxi-column
      dataField="activityName"
      [caption]="'STORES.COLUMNS.ACTIVITY' | translate"
      [allowFiltering]="true"
      [allowSorting]="true"
      [allowGrouping]="true"
      [width]="150">
    </dxi-column>

    <dxi-column
      dataField="branchName"
      [caption]="'STORES.COLUMNS.BRANCH' | translate"
      [allowFiltering]="true"
      [allowSorting]="true"
      [allowGrouping]="true"
      [width]="150">
    </dxi-column>

    <dxi-column
      dataField="status"
      [caption]="'STORES.COLUMNS.STATUS' | translate"
      [allowFiltering]="true"
      [allowSorting]="true"
      [allowGrouping]="true"
      [dataType]="'string'"
      [lookup]="{
        dataSource: [
          { value: 'active', displayExpr: 'STORES.STATUS.ACTIVE' | translate },
          { value: 'inactive', displayExpr: 'STORES.STATUS.INACTIVE' | translate },
          { value: 'suspended', displayExpr: 'STORES.STATUS.SUSPENDED' | translate }
        ],
        valueExpr: 'value',
        displayExpr: 'displayExpr'
      }"
      [width]="100">
    </dxi-column>

    <dxi-column
      dataField="createdAt"
      [caption]="'STORES.COLUMNS.CREATED' | translate"
      dataType="date"
      format="yyyy-MM-dd"
      [width]="120">
    </dxi-column>

    <dxi-column
      type="buttons"
      [width]="120"
      [caption]="'STORES.COLUMNS.ACTIONS' | translate">
      <dxi-button
        [hint]="'STORES.ACTIONS.EDIT' | translate"
        [icon]="'edit'"
        [onClick]="onEdit"
        >
      </dxi-button>
      <dxi-button
        [hint]="'STORES.ACTIONS.DELETE' | translate"
        [icon]="'trash'"
        [cssClass]="'btn-danger'"
        [onClick]="onDelete"
        >
      </dxi-button>
    </dxi-column>
  </dx-data-grid>
</div>
